# 🚀 SOFIA IA - EasyPanel Deploy Configuration

# Frontend (Vite React)
frontend:
  name: sofia-ia-frontend
  type: static
  build_command: npm run build
  output_directory: dist
  node_version: 18
  environment:
    VITE_API_URL: https://sofia-ia-backend.easypanel.app
    VITE_APP_NAME: Sofia IA
    VITE_NODE_ENV: production

# Backend (Node.js Express)  
backend:
  name: sofia-ia-backend
  type: nodejs
  start_command: node server-with-real-metrics.js
  node_version: 18
  port: 8000
  environment:
    NODE_ENV: production
    PORT: 8000
    API_BASE_URL: https://sofia-ia-backend.easypanel.app

# Docker Configuration (Alternativa)
docker:
  dockerfile: |
    FROM node:18-alpine
    WORKDIR /app
    
    # Backend
    COPY backend/package*.json ./backend/
    RUN cd backend && npm install --production
    COPY backend/ ./backend/
    
    # Frontend  
    COPY frontend/sofia-ai-lux-dash-main/package*.json ./frontend/
    RUN cd frontend && npm install
    COPY frontend/sofia-ai-lux-dash-main/ ./frontend/
    RUN cd frontend && npm run build
    
    # Start backend
    EXPOSE 8000
    CMD ["node", "backend/server-with-real-metrics.js"]

# Variáveis de Ambiente Necessárias
environment_variables:
  # API Configuration
  API_BASE_URL: https://sofia-ia-backend.easypanel.app
  CORS_ORIGIN: https://sofia-ia-frontend.easypanel.app
  
  # Database (se necessário no futuro)
  DATABASE_URL: postgresql://user:pass@host:5432/sofia_ia
  
  # External APIs (se integrar futuramente)
  EVOLUTION_API_URL: https://evolution-api.easypanel.app
  ANTHROPIC_API_KEY: sk-ant-api03-...
  
  # Security
  JWT_SECRET: sofia-ia-jwt-secret-2025
  
# Deploy Steps
deploy_steps:
  1: "npm install dependencies"
  2: "build frontend assets" 
  3: "start backend server"
  4: "configure reverse proxy"
  5: "setup SSL certificates"
  6: "configure domain"

# Health Checks
health_check:
  endpoint: /health
  interval: 30s
  timeout: 10s
  retries: 3

# Scaling Configuration
scaling:
  min_instances: 1
  max_instances: 3
  cpu_threshold: 70%
  memory_limit: 512MB

# Backup Configuration (se necessário)
backup:
  database: daily
  files: weekly
  retention: 30 days

# Monitoring
monitoring:
  logs: enabled
  metrics: enabled
  alerts: 
    - high_cpu_usage
    - memory_overflow  
    - endpoint_down
    
# Custom Domain
domain:
  frontend: sofia-ia.roilabs.com.br
  backend: api.sofia-ia.roilabs.com.br
  
# SSL Configuration
ssl:
  enabled: true
  force_https: true
  auto_renew: true