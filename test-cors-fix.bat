@echo off
echo.
echo =======================================
echo ðŸ”§ TESTE CORS CORRIGIDO - SOFIA IA
echo =======================================
echo.
echo ðŸŽ¯ Testando acesso de sofia-dash.roilabs.com.br
echo    para sofia-api.roilabs.com.br
echo.

echo ============================================
echo ðŸ“Š 1. TESTE HEALTH CHECK COM CORS DEBUG
echo ============================================
curl -v -H "Origin: https://sofia-dash.roilabs.com.br" ^
     -H "Access-Control-Request-Method: GET" ^
     -H "Access-Control-Request-Headers: Content-Type" ^
     -X OPTIONS "http://localhost:8000/health"

echo.
echo ============================================
echo ðŸ“Š 2. TESTE DASHBOARD OVERVIEW COM CORS
echo ============================================
curl -v -H "Origin: https://sofia-dash.roilabs.com.br" ^
     -H "Content-Type: application/json" ^
     "http://localhost:8000/api/dashboard/overview"

echo.
echo ============================================
echo ðŸ“± 3. TESTE WHATSAPP INSTANCES COM CORS
echo ============================================
curl -v -H "Origin: https://sofia-dash.roilabs.com.br" ^
     -H "Content-Type: application/json" ^
     "http://localhost:8000/api/whatsapp/instances"

echo.
echo ============================================
echo ðŸŽ¯ 4. TESTE REAL TIME STATS COM CORS
echo ============================================
curl -v -H "Origin: https://sofia-dash.roilabs.com.br" ^
     -H "Content-Type: application/json" ^
     "http://localhost:8000/api/realtime/stats"

echo.
echo ============================================
echo âœ… RESULTADO DOS TESTES CORS:
echo ============================================
echo Se os testes mostrarem headers CORS corretos:
echo Access-Control-Allow-Origin: https://sofia-dash.roilabs.com.br
echo.
echo EntÃ£o o frontend deveria funcionar!
echo.
echo ðŸ”§ Se ainda tiver erro, pode ser cache do browser.
echo    SoluÃ§Ã£o: Ctrl+Shift+R no browser para hard refresh
echo.
pause